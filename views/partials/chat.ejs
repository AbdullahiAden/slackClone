<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <!-- <link rel="stylesheet" href="public/styles/style.css"> -->
  </head>

  <body>
    <div class="conversationTab">
      <div class="conversation-header">
        <!-- * check if there is any channels in db -->
        <% if (typeof data !='undefined' ) { %>
        <div><%= data[0].channelName %></div>
        <div id="channelId"><%= data[0]._id %></div>

         <% } %>

         <!-- * DM  -->

         <% if (typeof dmUsers !='undefined' ) { %> 
          <%for (dmUser of dmUsers) { %>
          <div> <%= dmUser.userTo.name %></div>
          <div id="dmId"><%= dmUser.userTo._id %></div>
  
          <% } %> <% } %>
      
      </div>

      <!-- *MENTIONS -->
      <div class="mentionsDiv"> 
        <% if (typeof mentions !='undefined' ) { %>
          <% console.log("((((((") %> 
          <% console.log(mentions ) %> 
          <% console.log("((((((") %> 
          
          <!-- ** -->
          <%mentions.forEach(function(object) {  %> 
            <% object.conversation.forEach(function(subObject) { %> 
            <% console.log(subObject); %> 
            <% }); %> 
            <%  });%> 
            <!--**  -->

          <% for(mention of mentions){ %> 
            <p><%=mention.channelName  %> </p>

            <!-- <div class="eachMentionDiv"> <%#= mention.conversation %> </div> -->
              <%= user._id %>
              
            <!-- *loop through mention.conversation -->
            <% for( conv of mention.conversation){ %> 
              <div class="eachMentionDiv"> 

                 <!-- *  loop through user object and get name --> 

                <% if ( conv.user === user.id){ %> 
<% } %> 
                  <!-- *loop through user  -->
                  


                <%= conv.user %>
                <%= conv.message %> 
              </div>

              <%# console.log(conv) %> 

              <% } %> 
              
          <% } %> 
        
          
      <% } %>


      </div>
      




      <div class="messagefield">
        <!-- <form action="/messages/new" method="POST" id="form"> -->
          <form id="form">
          <input name="newMessage" id="msg" autocomplete="off" />
          <button id="submit-msg">send</button>
        </form>
      </div>


      <div class="chat-messages">
        <!-- * new messages will appear  -->

      </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="/public/scripts/main.js"></script>
    <!-- <script src="/public/scripts/message.js"></script>  -->
  </body>
</html>
